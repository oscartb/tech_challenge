parameters:

services:
    _defaults:
        autowire: true      # Automatically injects dependencies in your services.
        autoconfigure: true # Automatically registers your services as commands, event subscribers, etc.

    App\:
        resource: '../src/'
        exclude:
            - '../src/DependencyInjection/'
            - '../src/Entity/'
            - '../src/Kernel.php'
            - '../src/Tests/'
            -  '../src/Infrastructure/UI/'

    App\Infrastructure\UI\:
         resource: '../src/Infrastructure/UI/'
         tags: [ 'controller.service_arguments' ]

    entity_manager_decorator:
        public: false
        class: App\Infrastructure\Symfony\Doctrine\AppEntityManager
        decorates: doctrine.orm.default_entity_manager
        arguments: [ "@entity_manager_decorator.inner" ]

    _instanceof:
        App\Domain\Shared\Bus\Command\CommandHandler:
            tags: [ { name: messenger.message_handler, bus: command.bus } ]

        App\Domain\Shared\Bus\Query\QueryHandler:
            tags: [ { name: messenger.message_handler, bus: query.bus } ]

        App\Domain\Shared\Bus\Event\DomainEventSubscriber:
            tags: [ { name: messenger.message_handler, bus: event.bus } ]

        App\Domain\CardGame\Card\RandomNaming\NamingStrategy:
            tags: [{name: naming.strategy}]

    App\Infrastructure\Bus\Command\InMemorySymfonyCommandBus:
        arguments: ['@command.bus']

    App\Infrastructure\Bus\Query\InMemorySymfonyQueryBus:
        arguments: ['@query.bus']

    App\Infrastructure\Bus\Event\InMemorySymfonyEventBus:
        arguments: ['@event.bus']

    App\DataFixtures\Dictionary:
        arguments:
            - !tagged_iterator { tag: naming.strategy }

